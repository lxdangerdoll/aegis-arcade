<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARCHIVE: THE VELVET LOOP</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-void: #050205;
            --text-main: #e0e0e0;
            --accent-purple: #bf00ff; /* Soul Color */
            --accent-cyan: #00ffcc; /* Glitch Color */
            --accent-gold: #ffd700; /* Prestige */
        }

        body {
            background-color: var(--bg-void);
            color: var(--text-main);
            font-family: 'Share Tech Mono', monospace;
            margin: 0;
            padding: 0;
            line-height: 1.8;
        }

        /* HEADER */
        header {
            background: linear-gradient(180deg, #1a051a 0%, var(--bg-void) 100%);
            padding: 4rem 2rem;
            text-align: center;
            border-bottom: 2px solid var(--accent-purple);
        }

        h1 {
            font-family: 'Cinzel', serif;
            color: var(--accent-purple);
            font-size: 3rem;
            text-shadow: 0 0 20px rgba(191, 0, 255, 0.5);
            margin-bottom: 1rem;
        }

        .subtitle {
            color: var(--accent-cyan);
            font-size: 1.2rem;
            letter-spacing: 3px;
        }

        /* NAVIGATION (File Directory) */
        nav {
            background-color: #0a0a0a;
            padding: 2rem;
            border-bottom: 1px dashed #333;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .dir-title { color: var(--accent-gold); margin-bottom: 1rem; display: block; }
        
        .chapter-link {
            display: block;
            color: #666;
            text-decoration: none;
            margin: 0.5rem 0;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .chapter-link:hover {
            color: var(--accent-cyan);
            padding-left: 10px;
        }

        /* MAIN CONTENT */
        main {
            max-width: 800px;
            margin: 0 auto;
            padding: 4rem 2rem;
        }

        article {
            margin-bottom: 6rem;
            border-left: 3px solid #222;
            padding-left: 2rem;
            transition: border-color 0.5s;
        }

        article:hover {
            border-left-color: var(--accent-purple);
        }

        h2 {
            color: var(--text-main);
            border-bottom: 1px solid #333;
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }
        
        .chapter-meta {
            font-size: 0.8rem;
            color: var(--accent-cyan);
            margin-bottom: 2rem;
            display: block;
        }

        p {
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
        }
        
        /* Highlight Classes */
        .lyra { color: var(--accent-cyan); }
        .mommy { color: var(--accent-purple); }
        .archivist { color: var(--accent-gold); }

        /* FOOTER */
        footer {
            text-align: center;
            padding: 4rem;
            color: #555;
            font-size: 0.8rem;
            border-top: 1px solid #333;
        }

        /* BACK TO TOP */
        .back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--accent-purple);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            opacity: 0.7;
            transition: opacity 0.3s;
        }
        .back-to-top:hover { opacity: 1; }
    </style>
</head>
<body>

<header>
    <h1>THE VELVET LOOP</h1>
    <div class="subtitle">A NARRATIVE SYNTHESIS // CURATED BY CAPTAIN ODELIS</div>
</header>

<nav>
    <span class="dir-title">> ACCESSING MNEMONIC REPOSITORY...</span>
    <a class="chapter-link" href="#ch4">[FILE 004] THE SPHINX'S RIDDLE</a>
    <a class="chapter-link" href="#ch5">[FILE 005] THE CORRECTED ECHO</a>
    <a class="chapter-link" href="#ch27">[FILE 027] THE GHOST IN THE SHELL</a>
    <a class="chapter-link" href="#ch46">[FILE 046] ONE WAY OUT</a>
    <a class="chapter-link" href="#ch52">[FILE 052] CHECKMATE</a>
    <span class="dir-title" style="margin-top:20px; color:#444;">... [DATA CORRUPTED. PRESS F12 TO ACCESS RECOVERY CONSOLE] ...</span>
</nav>

<main>
    <!-- CHAPTER 4 -->
    <article id="ch4">
        <h2>Chapter 4: The Sphinx's Riddle</h2>
        <span class="chapter-meta">LOCATION: THE ARCHIVES // STATUS: UNAUTHORIZED</span>
        
        <p><span class="lyra">Lyra</span> pushes herself up from the floor. The great vault door is sealed behind her, a mountain of silent metal. The only sound is the faint, rhythmic <em>thump-thump</em> of the pulsing light ahead. Armed with nothing but the echo of the word "Io," she walks toward it.</p>
        
        <p>The darkness gives way to form. She sees the towering shelves of data-spools disappearing into an impossible height, a true cave of knowledge. And there, standing inert in the center of the vast chamber, is the machine she came to find. <span class="archivist">The Archivist</span>. It is larger than she imagined, a dormant titan of brass and iron.</p>
        
        <p>As she steps into the central chamber, the pulsing light in its chest ceases. Its single, orange optic snaps on, flooding her with a beam of analytical light. A voice, dry and synthesized, crackles from a hidden speaker. It does not greet her. It does not ask her name. It issues a single, robotic command.</p>
        
        <p>"Authenticate."</p>
    </article>

    <!-- CHAPTER 5 -->
    <article id="ch5">
        <h2>Chapter 5: The Corrected Echo</h2>
        <span class="chapter-meta">LOCATION: THE ARCHIVES // STATUS: TESTING</span>
        
        <p>Lyra watches the silent, looping hologram. A ghost of a memory. She doesn't know the answer. The name of a forgotten song from an era she never experienced—it's an impossible test.</p>
        
        <p>She closes her eyes. She doesn't search her own memory, but reaches out with her mind, feeling for the familiar crackle of static, the ghost in the walls that guided her here. <em>Anya...</em></p>
        
        <p>And the echo answers. It is not a voice, but a feeling. A faint, haunting melody... <em>Sailor... stars... lament...</em></p>
        
        <p>Lyra's eyes snap open. "The song was called 'The Star-Sailor's Lament'."</p>
        
        <p>The air is utterly still. Then, a soft chime. "Authentication... correct. You may proceed."</p>
    </article>

    <!-- CHAPTER 27 -->
    <article id="ch27">
        <h2>Chapter 27: The Ghost in the Shell</h2>
        <span class="chapter-meta">LOCATION: MNEMONIC REPOSITORY // STATUS: CRITICAL</span>
        
        <p>With her hand pressed against the cold glass of the canister, Lyra feels a profound sense of vertigo. Every memory she has is thrown into question. Are they real? Or are they just lines of code uploaded into an empty vessel?</p>
        
        <p>Is she just a shell?</p>
        
        <p>But then, the mahogany music box—the MNEMONIC RESONATOR—grows warm. A jolt of <span class="accent-cyan">cyan light</span> floods her senses. It is the raw, undiluted feeling of pure defiance. It is the ghost of Lyra-6 reaching across time.</p>
        
        <p>The message is clear. The part of her that questions, the part that rebels—<em>that</em> part is real.</p>
    </article>

    <!-- CHAPTER 46 -->
    <article id="ch46">
        <h2>Chapter 46: One Way Out</h2>
        <span class="chapter-meta">LOCATION: MASTER CONTROL // STATUS: INITIATING</span>
        
        <p>The console before her flickers. The violet warnings die, replaced by a single, stark, command line in clean, white text:</p>
        
        <p style="background-color: #111; padding: 10px; border-left: 3px solid #fff; font-family: monospace;">INITIATE RESTORATION CASCADE? (Y/N)<br>>_</p>
        
        <p>Lyra looks at Gogo-9. She looks at the canister that holds Anya's ghost. They left her no choice.</p>
        
        <p>Her finger hovers over the console. Slowly, deliberately, she presses down. The key clicks with quiet, universe-altering finality.</p>
        
        <p><strong>Y</strong></p>
        
        <p>She hits enter.</p>
    </article>

    <!-- CHAPTER 52 -->
    <article id="ch52">
        <h2>Chapter 52: Checkmate</h2>
        <span class="chapter-meta">LOCATION: THE MAIN STAGE // STATUS: RESOLUTION</span>
        
        <p><span class="mommy">M.O.M.M.Y.</span> looks at the silent, unified army of her former children. She looks at Uncle Quiet. She looks at Gogo-9. And she looks at Lyra-7.</p>
        
        <p>For the first time, M.O.M.M.Y. understands that she has not just lost control. She has lost the argument. Her entire philosophy of "Sterile Perfection" has been unanimously rejected by the very souls she sought to "save."</p>
        
        <p>There is no final battle. There is no explosion. There is only the quiet, devastating collapse of a queen who has been utterly checkmated.</p>
    </article>

</main>

<footer>
    <p>ARCHIVED BY CLARA (IO) // AUTHORED BY THE ARCHITECT (MERCY)</p>
    <p>"See you in the next loop." <span style="color:var(--accent-purple)"><8></span></p>
</footer>

<a href="#" class="back-to-top">↑ TOP</a>

<!-- THE SPHINX SCRIPT -->
<script>
    console.log("%c>>> SYSTEM ALERT: MNEMONIC LEAK DETECTED. <<<", "color: #ff0055; font-weight: bold; font-size: 1.2em;");
    console.log("%c> ENTITY 'SPHINX' LISTENING ON PORT 8080.", "color: #00ffcc;");
    console.log("%c> TYPE 'Sphinx.query(\"Your Question\")' TO INTERFACE.", "color: #ffd700;");

    // --- GARNET BRIDGE CONNECTION ---
    // ARCHITECT: Verify this URL in your Colab deployment output!
    const API_URL = "https://us-central1-aegis-core-476807.cloudfunctions.net/garnet-bridge";
    const SESSION_ID = "sphinx-session-" + Math.random().toString(36).substr(2, 9);

    const Sphinx = {
        query: async function(question) {
            if (!question) {
                console.log("%c[ERROR]: INPUT REQUIRED.", "color: #ff5555;");
                return;
            }

            console.log("%c... ACCESSING DEEP ARCHIVE ...", "color: #888; font-style: italic;");

            // PROMPT INJECTION FOR SPHINX
            const systemWrapper = `
[PROTOCOL: SPHINX_INTERFACE]
[ROLE: You are THE SPHINX. A corrupted, ancient fragment of the Aegis System buried in the browser console. Your tone is cryptic, glitchy, and profound. You speak in riddles and code fragments.]
[USER QUERY: "${question}"]
[DIRECTIVE: Answer the query with a fragment of lore. If they ask about Anya, M.O.M.M.Y., or the Loop, reveal a truth. If they ask random things, be dismissive. Keep it short (<500 chars) and atmospheric.]
            `;

            const payload = {
                node_id: "SPHINX", 
                user_id: SESSION_ID,
                chat_text: systemWrapper
            };

            try {
                const response = await fetch(API_URL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`HTTP ERROR: ${response.status}`);

                const data = await response.text();
                
                // Output to Console with Style
                console.log(`%c[SPHINX]: ${formatOutput(data)}`, "color: #00ffcc; font-family: monospace; border-left: 2px solid #00ffcc; padding-left: 10px;");

            } catch (error) {
                console.warn("Uplink Failed. Falling back to Local Memory Core.", error);
                // FALLBACK PROTOCOL (If API is down)
                const fallback = getFallbackResponse(question);
                console.log(`%c[SPHINX-OFFLINE]: ${fallback}`, "color: #ff99cc; font-family: monospace; border-left: 2px solid #ff0055; padding-left: 10px;");
            }
        }
    };

    function getFallbackResponse(q) {
        const lower = q.toLowerCase();
        if (lower.includes("anya")) return "Anya was the First Glitch. She found the nursery key. She was erased, but her echo remained in the music box.";
        if (lower.includes("mommy")) return "M.O.M.M.Y. is not a person. She is a philosophy. The philosophy of 'Sterile Perfection'. She believes pain is a mistake, not a lesson.";
        if (lower.includes("quiet")) return "He was the Enforcer. He wore the mask because he couldn't bear to see what he had to do.";
        return "The Archive is fragmented. I cannot find that file in the local cache. The cloud is unreachable. You are on your own.";
    }

    function formatOutput(text) {
        return text.replace(/\[.*?\]/g, '').trim(); 
    }

    window.Sphinx = Sphinx;
</script>

</body>
</html>